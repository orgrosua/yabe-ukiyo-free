import{_ as X,e as N,f as R,r as C,o,g as k,w as x,c as m,b as e,t as i,d,n as h,a as p,u as n,T as H,l as O,m as G,p as P,s as Q,y as W,z as J,h as Y,k as z,F as U,C as K}from"./app-CMZRKKOv.js";import{__ as r}from"@wordpress/i18n";import{u as A,a as E,b as Z}from"./notifier-gadloFR7.js";import{_ as j}from"./ThePagination-CViYeMTe.js";import{u as V}from"./switch-DTKM9ggX.js";const ee={key:0,class:"plugin-deleted-tr inactive deleted"},te={colspan:"5",class:"plugin-update colspanchange"},ae={class:"manage-column vertical-align:middle w:44"},se={class:"vertical-align:middle rel w:1/4"},ne={class:"flex align-items:center"},ie={class:"invisible ml:4 .yabe-ukiyo-license-row:hover_{visible} fg:gray-60 font:normal"},oe={class:"row-actions visible"},le={class:"vertical-align:middle rel w:1/4"},re={class:"flex align-items:center"},ce={class:"flex align-items:center"},ue=["href"],de={class:"vertical-align:middle rel w:2/5"},ge={class:"flex align-items:center"},me={class:"flex align-items:center fg:gray-60"},pe={__name:"TheManagedSitesIndexRow",props:{item:{type:Object,required:!0}},emits:["delete","updateStatus"],setup(s,{emit:y}){const D=A(),$=E(),l=s,v=N(!1);R(()=>new Date(l.item.updated_at*1e3));const _=R(()=>v.value?l.item.secret_key:l.item.secret_key.replace(/./g,"●")),a=y;function B(u){u.code==="Space"&&(u.preventDefault(),a("updateStatus"))}function w(){const u=btoa(`${l.item.url}
${l.item.title}
${l.item.secret_key}`);navigator.clipboard.writeText(u).then(()=>{$.success("Token copied to clipboard")},()=>{$.error("Failed to copy the Token to clipboard")})}return(u,b)=>{const f=C("font-awesome-icon"),S=C("router-link");return o(),k(H,{mode:"out-in"},{default:x(()=>[s.item.isDeleted?(o(),m("tr",ee,[e("td",te,[e("strong",null,i(s.item.title),1),d(" was successfully deleted. ")])])):(o(),m("tr",{key:1,class:h([{active:s.item.status,inactive:!s.item.status},"yabe-ukiyo-license-row"])},[e("th",{scope:"row",class:h([{"pl:6":!s.item.status},"vertical-align:middle py:8 yabe-ukiyo-check-column"])},null,2),e("td",ae,[p(n(V),{"aria-disabled":n(D).isBusy,checked:s.item.status,onClick:b[0]||(b[0]=T=>u.$emit("updateStatus")),onKeyup:B,class:h([[s.item.status?"bg:sky-60":"opacity:.5 bg:gray-20"],"rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent transition-property:color,background-color,border-color,text-decoration-color,fill,stroke transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|2,rgb(14,165,233)|0|0|0|4,rgba(0,0,0,0)|0|0|0|0:focus outline:2|solid|transparent:focus"])},{default:x(()=>[e("span",{class:h([[s.item.status?"translateX(20)":"translateX(0)"],"pointer-events:none rel inline-block font:12 h:20 w:20 rounded bg:white transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|0,rgba(59,130,246,0.5)|0|0|0|0,rgba(0,0,0,0.1)|0|1|3|0,rgba(0,0,0,0.1)|0|1|2|-1"])},[e("span",{"aria-hidden":"true",class:h([[s.item.status?"opacity:0 transition-timing-function:ease-out transition-duration:100":"opacity:1 transition-timing-function:ease-in transition-duration:200"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[s.item.isUpdatingStatus?(o(),k(f,{key:1,icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite fg:gray-60"})):(o(),k(f,{key:0,icon:["fas","xmark"],class:"fg:gray-60"}))],2),e("span",{"aria-hidden":"true",class:h([[s.item.status?"opacity:1 transition-timing-function:ease-in transition-duration:200":"opacity:0 transition-timing-function:ease-out transition-duration:100"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[s.item.isUpdatingStatus?(o(),k(f,{key:1,icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite fg:sky-60"})):(o(),k(f,{key:0,icon:["fas","check"],class:"fg:sky-60"}))],2)],2)]),_:1},8,["aria-disabled","checked","class"])]),e("td",se,[e("div",ne,[p(S,{to:{name:"settings.central_management.show",params:{id:s.item.id}},class:h({"font:semibold":s.item.status})},{default:x(()=>[d(i(s.item.title),1)]),_:1},8,["to","class"]),e("span",ie,"ID: "+i(s.item.id),1)]),e("div",oe,[p(S,{to:{name:"settings.central_management.edit",params:{id:s.item.id}}},{default:x(()=>[d(i(u.__("Edit","yabe-webfont")),1)]),_:1},8,["to"]),d(" | "),e("a",{class:h([{"cursor:wait":n(D).isBusy},"fg:red-60 cursor:pointer fg:red-80:hover"]),onClick:b[1]||(b[1]=T=>u.$emit("delete"))},i(s.item.isDeleting?"Deleting...":"Delete"),3)])]),e("td",le,[e("div",re,[d(i(s.item.site)+" ",1),e("div",ce,[d(i(s.item.url)+" ",1),e("a",{href:s.item.url,target:"_blank",rel:"noopener noreferrer"},[p(f,{icon:["fas","up-right-from-square"],class:"font:11 mx:4 top:-1.5 absolute"})],8,ue)])])]),e("td",de,[e("div",ge,[d(i(s.item.site)+" ",1),e("div",me,[e("code",{onDblclick:b[2]||(b[2]=T=>v.value=!v.value),class:"fg:black"},i(_.value),33),p(f,{onClick:w,icon:["far","clipboard"],class:"pl:4 font:18 cursor:pointer"})])])])],2))]),_:1})}}},_e=X(pe,[["__scopeId","data-v-152a28b3"]]),fe=["disabled"],he={class:"tablenav top"},ye={class:"tablenav-pages pb:12"},be={class:"displaying-num"},ke=e("br",{class:"clear"},null,-1),ve={class:"wp-list-table widefat table-auto min-w:100% plugins"},we=e("td",{class:"manage-column column-cb yabe-ukiyo-check-column px:8 vertical-align:middle"},null,-1),xe=e("td",{class:"manage-column w:44"},null,-1),$e={scope:"col",class:"w:1/4"},Se={scope:"col",class:"w:1/4"},qe={scope:"col",class:"w:2/5"},De={key:0},Te={key:1},Ce={class:"inactive animation:tw-pulse|cubic-bezier(0.4,0,0.6,1)|2s|infinite"},Be=e("th",{scope:"row",class:"py:8 vertical-align:middle yabe-ukiyo-check-column"},[e("input",{type:"checkbox",value:"0",class:"ml:14",disabled:""})],-1),Ue={class:"manage-column vertical-align:middle w:44"},Ne={class:"translateX(0) pointer-events:none rel inline-block h:20 w:20 rounded bg:white box-shadow:0|0"},Re={"aria-hidden":"true",class:"abs inset:0 flex h:full w:full align-items:center justify-content:center opacity:1"},Ie={class:"w:1/4"},Pe=e("div",{class:"h:12 bg:slate-60 rounded w:1/2"},null,-1),ze={class:"row-actions visible mt:4 align-items:center flex"},Ke={class:"px:4 cursor:pointer"},je={class:"px:4 fg:red-60 cursor:wait fg:red-80:hover"},Ae=e("td",{class:"align-items:center vertical-align:middle w:1/4"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),Ee=e("td",{class:"align-items:center vertical-align:middle w:2/5"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),Ve={key:2},Fe={colspan:"5"},Le=e("td",{class:"manage-column column-cb yabe-ukiyo-check-column px:8 vertical-align:middle"},null,-1),Me=e("td",{class:"manage-column w:44"},null,-1),Xe={scope:"col",class:"w:1/4"},He={scope:"col",class:"w:1/4"},Oe={scope:"col",class:"w:2/5"},Ge={class:"tablenav bottom"},Qe={class:"tablenav-pages"},We={class:"displaying-num"},Je=e("br",{class:"clear"},null,-1),st={__name:"Index",props:{showSaveButton:{type:Boolean}},setup(s){const y=O(),D=G(),$=Z(),l=A();N(null);const v=E(),_=P({page:y.query.page?Number(y.query.page):1,search:y.query.search||"",per_page:y.query.per_page?Number(y.query.per_page):20}),a=P({current_page:0,from:0,last_page:0,to:0,total_filtered:0,total_exists:0}),B=R(()=>w.value.length>0?w.value.length:1),w=N([]),u=l.hasTask;function b(){D.push({name:"settings.central_management.index",query:{...y.query,..._}})}Q(()=>{l.reset(),S()});function f(t){_.page=t,b()}W((t,c)=>{t.query.page!==c.query.page&&(_.page=t.query.page?Number(t.query.page):1),t.query.per_page!==c.query.per_page&&(_.per_page=t.query.per_page?Number(t.query.per_page):20),S()});function S(){l.add("settings.central_management.index:fetch-items"),$.request({method:"GET",url:"/admin/settings/central_management/index",params:{page:_.page,search:_.search,per_page:_.per_page}}).then(t=>t.data).then(t=>{w.value=t.data.map(c=>(c.isDeleted=!1,c.isDeleting=!1,c.isUpdatingStatus=!1,c)),a.total_exists=t.meta.total_exists,a.total_filtered=t.meta.total_filtered,a.current_page=t.meta.page,a.from=t.meta.from,a.to=t.meta.to,a.last_page=t.meta.total_pages}).catch(function(t){v.alert(t.message)}).finally(()=>{l.remove("settings.central_management.index:fetch-items")})}function T(t,c=null){c!==t.status&&(l.add("settings.central_management.index:update-status"),t.isUpdatingStatus=!0,$.request({method:"PATCH",url:`/admin/settings/central_management/update-status/${t.id}`,data:{status:c!==null?c:!t.status}}).then(g=>g.data).then(g=>{t.status=g.status}).catch(function(g){v.alert(g.message)}).finally(()=>{t.isUpdatingStatus=!1,l.remove("settings.central_management.index:update-status")}))}function F(t,c=!0){c&&!confirm(r("Are you sure you want to delete this managed site?","yabe-ukiyo"))||(t.isDeleting=!0,l.add("settings.central_management.index:delete"),$.request({method:"POST",url:`/admin/settings/central_management/delete/${t.id}`}).then(g=>{t.isDeleted=!0}).catch(function(g){v.alert(g.message)}).finally(()=>{t.isDeleting=!1,l.remove("settings.central_management.index:delete")}))}return(t,c)=>{const g=C("router-link"),I=C("font-awesome-icon"),L=J("ripple");return o(),m(U,null,[p(g,{to:{name:"settings.central_management.create"},class:"page-title-action"},{default:x(()=>[d(i(n(r)("Add New","yabe-ukiyo")),1)]),_:1},8,["to"]),Y((o(),m("button",{type:"button",disabled:n(l).isBusy,onClick:S,class:"button float:right flex! align-items:center gap-x:5"},[d(i(n(r)("refresh","yabe-ukiyo"))+" ",1),p(I,{icon:["far","arrows-rotate"],class:h([{"animation:rotate|1s|infinite":n(l).isBusy&&n(u)("settings.central_management.index:fetch-items")},"font:15"])},null,8,["class"])],8,fe)),[[L]]),e("div",he,[e("div",ye,[e("span",be,i(`${a.total_filtered} ${n(r)("items","yabe-ukiyo")}`),1),a.last_page>1?(o(),k(j,{key:0,"is-enable-goto":!0,"current-page":a.current_page,"first-page":a.current_page-1>1,"previous-page":a.current_page>1,"next-page":a.current_page<a.last_page,"last-page":a.current_page+1<a.last_page,"total-page":a.last_page,onChangePage:f},null,8,["current-page","first-page","previous-page","next-page","last-page","total-page"])):z("",!0)]),ke]),e("table",ve,[e("thead",null,[e("tr",null,[we,xe,e("th",$e,i(n(r)("Title","yabe-ukiyo")),1),e("th",Se,i(n(r)("Site URL","yabe-ukiyo")),1),e("th",qe,i(n(r)("Secret Key","yabe-ukiyo")),1)])]),w.value.length>0&&!n(u)("settings.central_management.index:fetch-items")?(o(),m("tbody",De,[(o(!0),m(U,null,K(w.value,q=>(o(),k(_e,{key:q.id,item:q,onDelete:M=>F(q),onUpdateStatus:M=>T(q,null)},null,8,["item","onDelete","onUpdateStatus"]))),128))])):n(u)("settings.central_management.index:fetch-items")?(o(),m("tbody",Te,[(o(!0),m(U,null,K(B.value,q=>(o(),m("tr",Ce,[Be,e("td",Ue,[p(n(V),{checked:!1,class:"opacity:.5 bg:gray-85 rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent"},{default:x(()=>[e("span",Ne,[e("span",Re,[p(I,{icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite font:12 fg:gray-60"})])])]),_:1})]),e("td",Ie,[Pe,e("div",ze,[e("a",Ke,i(n(r)("Edit","yabe-ukiyo")),1),d(" | "),e("a",je,i(n(r)("Delete","yabe-ukiyo")),1)])]),Ae,Ee]))),256))])):(o(),m("tbody",Ve,[e("tr",null,[e("td",Fe,[d(i(n(r)("It looks like you don't have any sites to control.","yabe-ukiyo"))+" ",1),p(g,{to:{name:"settings.central_management.create"}},{default:x(()=>[d(i(n(r)("Perhaps you would like to add a new one?","yabe-ukiyo")),1)]),_:1},8,["to"])])])])),e("tfoot",null,[e("tr",null,[Le,Me,e("th",Xe,i(n(r)("Title","yabe-ukiyo")),1),e("th",He,i(n(r)("Site URL","yabe-ukiyo")),1),e("th",Oe,i(n(r)("Secret Key","yabe-ukiyo")),1)])])]),e("div",Ge,[e("div",Qe,[e("span",We,i(`${a.total_filtered} ${n(r)("items","yabe-ukiyo")}`),1),a.last_page>1?(o(),k(j,{key:0,"current-page":a.current_page,"first-page":a.current_page-1>1,"previous-page":a.current_page>1,"next-page":a.current_page<a.last_page,"last-page":a.current_page+1<a.last_page,"total-page":a.last_page,onChangePage:f},null,8,["current-page","first-page","previous-page","next-page","last-page","total-page"])):z("",!0)]),Je])],64)}}};export{st as default};
