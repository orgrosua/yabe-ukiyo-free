import{m as R,E as $,e as f,x as E,G as K,r as M,z as j,o as p,c as g,b as e,t as l,u as a,h,a as m,d as _,A as V,F as B,n as u,k as A,H as L,g as N,w as D,D as n}from"./app-Ce5S3xnu.js";import{d as O}from"./debounce-XxfNuXcX.js";import{b as X,a as Y,u as G}from"./notifier-CN7pR-B_.js";import{u as H,a as W,o as I}from"./switch-CMK24Cj1.js";import"./isObjectLike-mqpIr8Ea.js";import"./isSymbol-BpHlYMiq.js";const J={class:"mr:8 font:24"},Q={class:"form-table",role:"presentation"},Z={scope:"row"},ee={class:"flex"},te=e("span",{class:"text"},"Paste Token",-1),ae=e("p",{class:"description"}," Paste the Token produced by Yabe Ukiyo to fill the below fields automatically. ",-1),se={scope:"row"},ne=e("span",{class:"fg:red-35"},"*",-1),oe={scope:"row"},le=e("span",{class:"fg:red-35"},"*",-1),ie={key:0,class:"description"},re={key:0},ce={class:"font:semibold"},ue=e("br",null,null,-1),de=e("span",{class:"font:semibold"},"Bricks: ",-1),fe=e("br",null,null,-1),pe=e("span",{class:"font:semibold"},"Yabe Ukiyo: ",-1),me={scope:"row"},ye=e("span",{class:"fg:red-35"},"*",-1),be={class:"flex"},ve={class:"rel flex mr:8 align-items:center"},ge=["type"],_e=e("p",{class:"description"},null,-1),ke={scope:"row"},he=["disabled"],Be={__name:"Create",props:{showSaveButton:{type:Boolean}},setup(we){const S=X(),T=R(),F=Y(),w=G(),z=$(),k=f(!0),b=f(""),v=f(""),i=f(!0),y=f(""),C=f(null),x={status:null,connected:!1,yabeUkiyoDetected:!1,bricksDetected:!1},s=f({...x});E(y,O((c,t)=>{c!==t&&(s.value={...x},c!==""&&C.value.checkValidity()&&(s.value.status="loading",S.request({method:"POST",url:"/admin/settings/central_management/check-connection",data:{url:new URL(c.trim().replace(/\/$/,"")).origin}}).then(o=>{o.status===200?(s.value={...s.value,status:!0,connected:!0},s.value.yabeUkiyoDetected=o.data.namespaces.find(d=>d==="yabe-ukiyo/v1")!==void 0,s.value.bricksDetected=o.data.namespaces.find(d=>d==="bricks/v1")!==void 0):s.value.status=!1}).catch(o=>{s.value={...x,status:!1}})))},100));function U(){v.value="",y.value="",b.value="",i.value=!0}K(()=>{U()});function q(c){c.preventDefault(),w.add("settings.central_management.create:send-form");let t=S.request({method:"POST",url:"/admin/settings/central_management/store",data:{title:v.value,secret_key:b.value,status:i.value,url:y.value}}).then(o=>{const d=T.resolve({name:"settings.central_management.edit",params:{id:o.data.id}}).href;z.add({type:"success",message:`<p>Site saved successfully. <a href="${d}">Edit Site</a></p>`}),U()}).finally(()=>{w.remove("settings.central_management.create:send-form")});F.async(t,"Site stored successfully.",void 0,"Storing site...")}function P(){navigator.clipboard.readText().then(c=>{try{const t=atob(c).split(`
`);t.length===3&&(y.value=t[0],v.value=t[1],b.value=t[2])}catch{}})}return(c,t)=>{const o=M("font-awesome-icon"),d=j("ripple");return p(),g(B,null,[e("span",J,"Â» "+l(a(n)("New","yabe-ukiyo")),1),e("form",{onSubmit:q},[e("div",null,[e("table",Q,[e("tbody",null,[e("tr",null,[e("th",Z,[e("label",null,l(a(n)("Token","yabe-ukiyo")),1)]),e("td",null,[e("div",ee,[h((p(),g("div",{onClick:t[0]||(t[0]=r=>P()),class:"button flex align-items:center"},[m(o,{icon:["fas","paste"],class:"font:15 mr:6"}),te])),[[d]])]),ae])]),e("tr",null,[e("th",se,[e("label",null,[_(l(a(n)("Title","yabe-ukiyo"))+" ",1),ne])]),e("td",null,[h(e("input",{type:"text",name:"title","onUpdate:modelValue":t[1]||(t[1]=r=>v.value=r),required:""},null,512),[[V,v.value,void 0,{trim:!0,lazy:!0}]])])]),e("tr",null,[e("th",oe,[e("label",null,[_(l(a(n)("Site URL","yabe-ukiyo"))+" ",1),le])]),e("td",null,[h(e("input",{type:"url",ref_key:"urlField",ref:C,name:"url","onUpdate:modelValue":t[2]||(t[2]=r=>y.value=r),required:""},null,512),[[V,y.value,void 0,{trim:!0,lazy:!0}]]),s.value.status!==null?(p(),g("p",ie,[s.value.status==="loading"?(p(),g("span",re,[m(o,{icon:["fas","spinner"],class:"mr:4 fg:gray-60 animation:rotate|linear|1s|infinite"}),_(" "+l(a(n)("Connecting","yabe-ukiyo"))+"... ",1)])):(p(),g(B,{key:1},[e("span",ce,l(a(n)("Server","yabe-ukiyo"))+": ",1),e("span",{class:u(s.value.connected?"fg:green-50":"fg:red-40")},l(s.value.connected?a(n)("Connected","yabe-ukiyo"):a(n)("Failed to connect","yabe-ukiyo")),3),ue,de,e("span",{class:u(s.value.bricksDetected?"fg:green-50":"fg:red-40")},l(s.value.bricksDetected?a(n)("Detected","yabe-ukiyo"):a(n)("Not detected","yabe-ukiyo")),3),fe,pe,e("span",{class:u(s.value.yabeUkiyoDetected?"fg:green-50":"fg:yellow-60")},l(s.value.yabeUkiyoDetected?a(n)("Detected","yabe-ukiyo"):a(n)("Not detected","yabe-ukiyo")),3)],64))])):A("",!0)])]),e("tr",null,[e("th",me,[e("label",null,[_(l(a(n)("Secret Key","yabe-ukiyo"))+" ",1),ye])]),e("td",null,[e("div",be,[e("div",ve,[h(e("input",{type:k.value?"text":"password",name:"secret_key","onUpdate:modelValue":t[3]||(t[3]=r=>b.value=r),autocomplete:"current-password",class:"min-w:300 hide::-ms-reveal"},null,8,ge),[[L,b.value]]),e("span",{onClick:t[4]||(t[4]=r=>k.value=!k.value),class:"flex align-items:center ml:-24 fg:gray-60 fg:gray-40:hover cursor:pointer"},[k.value?(p(),N(o,{key:1,icon:["fas","eye-slash"],class:"font:15"})):(p(),N(o,{key:0,icon:["fas","eye"],class:"font:15"}))])])]),_e])]),e("tr",null,[e("th",ke,[e("label",null,l(a(n)("Status","yabe-ukiyo")),1)]),e("td",null,[m(a(I),{as:"div",class:"flex align-items:center"},{default:D(()=>[m(a(H),{modelValue:i.value,"onUpdate:modelValue":t[5]||(t[5]=r=>i.value=r),class:u([[i.value?"bg:sky-60":"opacity:.5 bg:gray-20"],"rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent transition-property:color,background-color,border-color,text-decoration-color,fill,stroke transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|2,rgb(14,165,233)|0|0|0|4,rgba(0,0,0,0)|0|0|0|0:focus outline:2|solid|transparent:focus"])},{default:D(()=>[e("span",{class:u([[i.value?"translateX(20)":"translateX(0)"],"pointer-events:none rel inline-block font:12 h:20 w:20 rounded bg:white transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|0,rgba(59,130,246,0.5)|0|0|0|0,rgba(0,0,0,0.1)|0|1|3|0,rgba(0,0,0,0.1)|0|1|2|-1"])},[e("span",{"aria-hidden":"true",class:u([[i.value?"opacity:0 transition-timing-function:ease-out transition-duration:100":"opacity:1 transition-timing-function:ease-in transition-duration:200"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[m(o,{icon:["fas","xmark"],class:"fg:gray-60"})],2),e("span",{"aria-hidden":"true",class:u([[i.value?"opacity:1 transition-timing-function:ease-in transition-duration:200":"opacity:0 transition-timing-function:ease-out transition-duration:100"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[m(o,{icon:["fas","check"],class:"fg:sky-60"})],2)],2)]),_:1},8,["modelValue","class"]),m(a(W),{as:"span",class:u([[i.value?"fg:black":"fg:gray-60"],"ml:8 font:medium tw-cursor-pointer"])},{default:D(()=>[_(l(i.value?"enabled":"disabled"),1)]),_:1},8,["class"])]),_:1})])])])]),e("button",{type:"submit",name:"save",id:"save",disabled:a(w).isBusy,class:"button button-primary button-large",value:"save"},"Save",8,he)])],32)],64)}}};export{Be as default};
