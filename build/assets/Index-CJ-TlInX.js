import{_ as se,e as T,f as j,i as ae,r as z,o as c,g as $,w as D,c as g,b as e,t as i,d as p,n as v,h as U,j as ie,u as a,v as F,a as y,k as N,T as ne,l as oe,m as le,p as G,q as ce,s as re,x as ue,y as de,z as me,A as ge,B as pe,F as P,C as Q}from"./app-CMZRKKOv.js";import{__ as l}from"@wordpress/i18n";import{u as Y,a as Z,b as fe}from"./notifier-gadloFR7.js";import{_ as W}from"./TheBulkAction-DvqpyCzn.js";import{_ as J}from"./ThePagination-CViYeMTe.js";import{u as ee}from"./switch-DTKM9ggX.js";const ye={key:0,class:"plugin-deleted-tr inactive deleted"},he={colspan:"5",class:"plugin-update colspanchange"},_e=["value","disabled"],be={class:"manage-column vertical-align:middle w:44"},ve={class:"vertical-align:middle rel w:1/5"},ke={class:"flex align-items:center"},we={class:"invisible ml:4 .yabe-ukiyo-license-row:hover_{visible} fg:gray-60 font:normal"},xe={class:"row-actions visible"},$e={class:"vertical-align:middle rel w:1/5"},qe={class:"flex align-items:center"},De={class:"flex align-items:center fg:gray-60"},Be={class:"vertical-align:middle w:1/5"},Se={key:0,class:"flex align-items:center"},Ae={class:"ml:4 fg:gray-60 font:normal"},Te={class:"vertical-align:middle w:1/5"},Ue={class:"vertical-align:middle"},Ce={class:"flex align-items:center"},Ve={key:0,class:"pl:4"},Ie={__name:"TheLicenseIndexRow",props:{item:{type:Object,required:!0}},emits:["delete","updateStatus"],setup(n,{emit:h}){const C=Y(),B=Z(),u=n,V=T(!1),S=j(()=>new Date(u.item.expired_at*1e3)),f=new Date,o=j(()=>V.value?u.item.license_key:u.item.license_key.replace(/./g,"●")),L=h,m=ae("selectedItems");function k(_){_.code==="Space"&&(_.preventDefault(),L("updateStatus"))}function I(){const _=btoa(`${ukiyo.site_meta.site_url}
${ukiyo.site_meta.name}
${u.item.license_key}`);navigator.clipboard.writeText(_).then(()=>{B.success("Token copied to clipboard")},()=>{B.error("Failed to copy the Token to clipboard")})}return(_,b)=>{const w=z("font-awesome-icon"),A=z("router-link");return c(),$(ne,{mode:"out-in"},{default:D(()=>[n.item.isDeleted?(c(),g("tr",ye,[e("td",he,[e("strong",null,i(n.item.title),1),p(" was successfully deleted. ")])])):(c(),g("tr",{key:1,class:v([{active:n.item.status,inactive:!n.item.status},"yabe-ukiyo-license-row"])},[e("th",{scope:"row",class:v([{"pl:6":!n.item.status},"vertical-align:middle py:8 yabe-ukiyo-check-column"])},[U(e("input",{"onUpdate:modelValue":b[0]||(b[0]=q=>ie(m)?m.value=q:null),type:"checkbox",value:n.item.id,disabled:a(C).isBusy,class:"ml:14"},null,8,_e),[[F,a(m)]])],2),e("td",be,[y(a(ee),{"aria-disabled":a(C).isBusy,checked:n.item.status,onClick:b[1]||(b[1]=q=>_.$emit("updateStatus")),onKeyup:k,class:v([[n.item.status?"bg:sky-60":"opacity:.5 bg:gray-20"],"rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent transition-property:color,background-color,border-color,text-decoration-color,fill,stroke transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|2,rgb(14,165,233)|0|0|0|4,rgba(0,0,0,0)|0|0|0|0:focus outline:2|solid|transparent:focus"])},{default:D(()=>[e("span",{class:v([[n.item.status?"translateX(20)":"translateX(0)"],"pointer-events:none rel inline-block font:12 h:20 w:20 rounded bg:white transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|0,rgba(59,130,246,0.5)|0|0|0|0,rgba(0,0,0,0.1)|0|1|3|0,rgba(0,0,0,0.1)|0|1|2|-1"])},[e("span",{"aria-hidden":"true",class:v([[n.item.status?"opacity:0 transition-timing-function:ease-out transition-duration:100":"opacity:1 transition-timing-function:ease-in transition-duration:200"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[n.item.isUpdatingStatus?(c(),$(w,{key:1,icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite fg:gray-60"})):(c(),$(w,{key:0,icon:["fas","xmark"],class:"fg:gray-60"}))],2),e("span",{"aria-hidden":"true",class:v([[n.item.status?"opacity:1 transition-timing-function:ease-in transition-duration:200":"opacity:0 transition-timing-function:ease-out transition-duration:100"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[n.item.isUpdatingStatus?(c(),$(w,{key:1,icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite fg:sky-60"})):(c(),$(w,{key:0,icon:["fas","check"],class:"fg:sky-60"}))],2)],2)]),_:1},8,["aria-disabled","checked","class"])]),e("td",ve,[e("div",ke,[y(A,{to:{name:"licenses.show",params:{id:n.item.id}},class:v({"font:semibold":n.item.status})},{default:D(()=>[p(i(n.item.title),1)]),_:1},8,["to","class"]),e("span",we,"ID: "+i(n.item.id),1)]),e("div",xe,[y(A,{to:{name:"licenses.edit",params:{id:n.item.id}}},{default:D(()=>[p(i(_.__("Edit","yabe-webfont")),1)]),_:1},8,["to"]),p(" | "),e("a",{class:v([{"cursor:wait":a(C).isBusy},"fg:red-60 cursor:pointer fg:red-80:hover"]),onClick:b[2]||(b[2]=q=>_.$emit("delete"))},i(n.item.isDeleting?"Deleting...":"Delete"),3)])]),e("td",$e,[e("div",qe,[p(i(n.item.site)+" ",1),e("div",De,[e("code",{onDblclick:b[3]||(b[3]=q=>V.value=!V.value),class:"fg:black"},i(o.value),33),y(w,{onClick:I,icon:["far","clipboard"],class:"pl:4 font:18 cursor:pointer"})])])]),e("td",Be,[n.item.user?(c(),g("div",Se,[p(i(`${n.item.user.name} (${n.item.user.email})`)+" ",1),e("span",Ae,"#"+i(n.item.user.id),1)])):N("",!0)]),e("td",Te,[n.item.expired_at?(c(),g("div",{key:0,class:v([S.value.getTime()>a(f).getTime()?"fg:green-50":"fg:red-40","flex align-items:center"])},i(S.value.toISOString().split("T")[0]),3)):N("",!0)]),e("td",Ue,[e("div",Ce,[p(i(n.item.sites_count)+" / ",1),n.item.max_sites?(c(),g("span",Ve,i(n.item.max_sites),1)):(c(),$(w,{key:1,icon:["fas","infinity"],class:"pl:4 font:14 align-self:flex-end"}))])])],2))]),_:1})}}},Ee=se(Ie,[["__scopeId","data-v-6e6df778"]]),Ne={key:0,class:"subtitle"},Ke=["disabled"],Re=e("hr",{class:"invisible m:0 mt:-2"},null,-1),je={class:"subsubsub"},ze={class:"all"},Le={class:"count"},Pe={class:"search-box rel"},Fe=["disabled"],Me=["disabled"],Oe={class:"tablenav top"},Xe={class:"tablenav-pages pb:12"},He={class:"displaying-num"},Ge=e("br",{class:"clear"},null,-1),Qe={class:"wp-list-table widefat table-auto min-w:100% plugins"},We={class:"manage-column column-cb yabe-ukiyo-check-column px:8 vertical-align:middle"},Je=e("td",{class:"manage-column w:44"},null,-1),Ye={scope:"col",class:"w:1/5"},Ze={scope:"col",class:"w:1/5"},et={scope:"col",class:"w:1/5"},tt={scope:"col",class:"w:1/5"},st={scope:"col"},at={key:0},it={key:1},nt={class:"inactive animation:tw-pulse|cubic-bezier(0.4,0,0.6,1)|2s|infinite"},ot=e("th",{scope:"row",class:"py:8 vertical-align:middle yabe-ukiyo-check-column"},[e("input",{type:"checkbox",value:"0",class:"ml:14",disabled:""})],-1),lt={class:"manage-column vertical-align:middle w:44"},ct={class:"translateX(0) pointer-events:none rel inline-block h:20 w:20 rounded bg:white box-shadow:0|0"},rt={"aria-hidden":"true",class:"abs inset:0 flex h:full w:full align-items:center justify-content:center opacity:1"},ut={class:"w:1/5"},dt=e("div",{class:"h:12 bg:slate-60 rounded w:1/2"},null,-1),mt={class:"row-actions visible mt:4 align-items:center flex"},gt={class:"px:4 cursor:pointer"},pt={class:"px:4 fg:red-60 cursor:wait fg:red-80:hover"},ft=e("td",{class:"align-items:center vertical-align:middle w:1/5"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),yt=e("td",{class:"align-items:center vertical-align:middle w:1/5"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),ht=e("td",{class:"align-items:center vertical-align:middle w:1/5"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),_t=e("td",{class:"align-items:center vertical-align:middle"},[e("div",{class:"h:12 bg:slate-60 rounded w:1/2"})],-1),bt={key:2},vt={colspan:"5"},kt={class:"manage-column column-cb yabe-ukiyo-check-column px:8 vertical-align:middle"},wt=e("td",{class:"manage-column w:44"},null,-1),xt={scope:"col",class:"w:1/5"},$t={scope:"col",class:"w:1/5"},qt={scope:"col",class:"w:1/5"},Dt={scope:"col",class:"w:1/5"},Bt={scope:"col"},St={class:"tablenav bottom"},At={class:"tablenav-pages"},Tt={class:"displaying-num"},Ut=e("br",{class:"clear"},null,-1),Rt={__name:"Index",setup(n){const h=oe(),C=le(),B=fe(),u=Y(),V=T(null),S=Z(),f=G({page:h.query.page?Number(h.query.page):1,search:h.query.search||"",per_page:h.query.per_page?Number(h.query.per_page):20}),o=G({current_page:0,from:0,last_page:0,to:0,total_filtered:0,total_exists:0}),L=j(()=>m.value.length>0?m.value.length:1),m=T([]),k=T([]);ce("selectedItems",k);const I=u.hasTask;function _(){C.push({name:"licenses.index",query:{...h.query,...f}})}re(()=>{u.reset(),A()}),ue(()=>f.search,(t,s)=>{t===""&&h.query.search.trim()!==t&&w(!0)});function b(t){f.page=t,_()}de((t,s)=>{t.query.page!==s.query.page&&(f.page=t.query.page?Number(t.query.page):1),t.query.per_page!==s.query.per_page&&(f.per_page=t.query.per_page?Number(t.query.per_page):20),A()});function w(t=!1){f.page=1,t&&(f.search=""),_()}function A(){u.add("licenses.index:fetch-items"),B.request({method:"GET",url:"/admin/licenses/index",params:{page:f.page,search:f.search,per_page:f.per_page}}).then(t=>t.data).then(t=>{m.value=t.data.map(s=>(s.isDeleted=!1,s.isDeleting=!1,s.isUpdatingStatus=!1,s)),o.total_exists=t.meta.total_exists,o.total_filtered=t.meta.total_filtered,o.current_page=t.meta.page,o.from=t.meta.from,o.to=t.meta.to,o.last_page=t.meta.total_pages,E()}).catch(function(t){S.alert(t.message)}).finally(()=>{u.remove("licenses.index:fetch-items"),E()})}function q(t,s=null){s!==t.status&&(u.add("licenses.index:update-status"),t.isUpdatingStatus=!0,B.request({method:"PATCH",url:`/admin/licenses/update-status/${t.id}`,data:{status:s!==null?s:!t.status}}).then(r=>r.data).then(r=>{t.status=r.status}).catch(function(r){S.alert(r.message)}).finally(()=>{t.isUpdatingStatus=!1,u.remove("licenses.index:update-status")}))}function M(t,s=!0){s&&!confirm(l("Are you sure you want to delete this license?","yabe-ukiyo"))||(t.isDeleting=!0,u.add("licenses.index:delete"),B.request({method:"POST",url:`/admin/licenses/delete/${t.id}`}).then(r=>{t.isDeleted=!0}).catch(function(r){S.alert(r.message)}).finally(()=>{t.isDeleting=!1,u.remove("licenses.index:delete")}))}const K=j({get(){if(m.value.length>0){let t=!0;for(const[s,r]of m.value.entries())if(k.value.includes(r.id)||(t=!1),!t)break;return t}return!1},set(t){const s=[];t&&m.value.forEach(r=>{s.push(r.id)}),k.value=s}});function E(){k.value=[]}const R=T("-1"),O=T([{key:"activate",label:"Activate"},{key:"deactivate",label:"Deactivate"},{key:"delete",label:"Delete"}]);function X(t){if(t!=="-1")switch(t){case"delete":confirm(l("Are you sure you want to delete the selected license(s)?","yabe-ukiyo"))&&(k.value.forEach(async s=>{const r=m.value.find(x=>x.id===s);M(r,!1)}),E());break;case"deactivate":confirm(l("Are you sure you want to deactivate the selected license(s)?","yabe-ukiyo"))&&(k.value.forEach(async s=>{const r=m.value.find(x=>x.id===s);q(r,!1)}),E());break;case"activate":confirm(l("Are you sure you want to activate the selected license(s)?","yabe-ukiyo"))&&(k.value.forEach(async s=>{const r=m.value.find(x=>x.id===s);q(r,!0)}),E());break}}return(t,s)=>{const r=z("router-link"),x=z("font-awesome-icon"),H=me("ripple");return c(),g(P,null,[y(r,{to:{name:"licenses.create"},class:"page-title-action"},{default:D(()=>[p(i(a(l)("Add New","yabe-ukiyo")),1)]),_:1},8,["to"]),a(h).query.search?(c(),g("span",Ne,[p(i(a(l)("Search results for","yabe-ukiyo"))+": ",1),e("strong",null,i(a(h).query.search),1)])):N("",!0),U((c(),g("button",{type:"button",disabled:a(u).isBusy,onClick:A,class:"button float:right flex! align-items:center gap-x:5"},[p(i(a(l)("refresh","yabe-ukiyo"))+" ",1),y(x,{icon:["far","arrows-rotate"],class:v([{"animation:rotate|1s|infinite":a(u).isBusy&&a(I)("licenses.index:fetch-items")},"font:15"])},null,8,["class"])],8,Ke)),[[H]]),Re,e("ul",je,[e("li",ze,[y(r,{to:{name:"licenses.index",query:{...a(h).query,page:1}},class:"current"},{default:D(()=>[p(i(a(l)("All","yabe-ukiyo"))+" ",1),e("span",Le," ("+i(o.total_exists)+") ",1)]),_:1},8,["to"])])]),e("p",Pe,[U(e("input",{type:"search",id:"searchInput",name:"s","onUpdate:modelValue":s[0]||(s[0]=d=>f.search=d),onKeyup:s[1]||(s[1]=pe(d=>t.$refs.searchBtn.click(),["enter"])),disabled:a(u).isBusy},null,40,Fe),[[ge,f.search,void 0,{trim:!0,lazy:!0}]]),U((c(),g("button",{type:"button",class:"button flex! align-items:center gap-x:5",disabled:a(u).isBusy,ref_key:"searchBtn",ref:V,onClick:s[2]||(s[2]=d=>w())},[p(i(a(l)("search","yabe-ukiyo"))+" ",1),y(x,{icon:["fas","magnifying-glass"],class:"font:15"})],8,Me)),[[H]])]),e("div",Oe,[y(W,{modelValue:R.value,"onUpdate:modelValue":s[3]||(s[3]=d=>R.value=d),actions:O.value,onBulkActions:X},null,8,["modelValue","actions"]),e("div",Xe,[e("span",He,i(`${o.total_filtered} ${a(l)("items","yabe-ukiyo")}`),1),o.last_page>1?(c(),$(J,{key:0,"is-enable-goto":!0,"current-page":o.current_page,"first-page":o.current_page-1>1,"previous-page":o.current_page>1,"next-page":o.current_page<o.last_page,"last-page":o.current_page+1<o.last_page,"total-page":o.last_page,onChangePage:b},null,8,["current-page","first-page","previous-page","next-page","last-page","total-page"])):N("",!0)]),Ge]),e("table",Qe,[e("thead",null,[e("tr",null,[e("td",We,[U(e("input",{"onUpdate:modelValue":s[4]||(s[4]=d=>K.value=d),class:"ml:12",type:"checkbox"},null,512),[[F,K.value]])]),Je,e("th",Ye,i(a(l)("Title","yabe-ukiyo")),1),e("th",Ze,i(a(l)("License Key","yabe-ukiyo")),1),e("th",et,i(a(l)("User","yabe-ukiyo")),1),e("th",tt,i(a(l)("Expire","yabe-ukiyo")),1),e("th",st,i(a(l)("Activation","yabe-ukiyo")),1)])]),m.value.length>0&&!a(I)("licenses.index:fetch-items")?(c(),g("tbody",at,[(c(!0),g(P,null,Q(m.value,d=>(c(),$(Ee,{key:d.id,item:d,onDelete:te=>M(d),onUpdateStatus:te=>q(d,null)},null,8,["item","onDelete","onUpdateStatus"]))),128))])):a(I)("licenses.index:fetch-items")?(c(),g("tbody",it,[(c(!0),g(P,null,Q(L.value,d=>(c(),g("tr",nt,[ot,e("td",lt,[y(a(ee),{checked:!1,class:"opacity:.5 bg:gray-85 rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent"},{default:D(()=>[e("span",ct,[e("span",rt,[y(x,{icon:["fas","spinner"],class:"animation:rotate|linear|1s|infinite font:12 fg:gray-60"})])])]),_:1})]),e("td",ut,[dt,e("div",mt,[e("a",gt,i(a(l)("Edit","yabe-ukiyo")),1),p(" | "),e("a",pt,i(a(l)("Delete","yabe-ukiyo")),1)])]),ft,yt,ht,_t]))),256))])):(c(),g("tbody",bt,[e("tr",null,[e("td",vt,[p(i(a(l)("It looks like you don't have any licenses.","yabe-ukiyo"))+" ",1),y(r,{to:{name:"licenses.create"}},{default:D(()=>[p(i(a(l)("Perhaps you would like to add a new one?","yabe-ukiyo")),1)]),_:1},8,["to"])])])])),e("tfoot",null,[e("tr",null,[e("td",kt,[U(e("input",{"onUpdate:modelValue":s[5]||(s[5]=d=>K.value=d),class:"ml:12",type:"checkbox"},null,512),[[F,K.value]])]),wt,e("th",xt,i(a(l)("Title","yabe-ukiyo")),1),e("th",$t,i(a(l)("License Key","yabe-ukiyo")),1),e("th",qt,i(a(l)("User","yabe-ukiyo")),1),e("th",Dt,i(a(l)("Expire","yabe-ukiyo")),1),e("th",Bt,i(a(l)("Activation","yabe-ukiyo")),1)])])]),e("div",St,[y(W,{modelValue:R.value,"onUpdate:modelValue":s[6]||(s[6]=d=>R.value=d),actions:O.value,onBulkActions:X},null,8,["modelValue","actions"]),e("div",At,[e("span",Tt,i(`${o.total_filtered} ${a(l)("items","yabe-ukiyo")}`),1),o.last_page>1?(c(),$(J,{key:0,"current-page":o.current_page,"first-page":o.current_page-1>1,"previous-page":o.current_page>1,"next-page":o.current_page<o.last_page,"last-page":o.current_page+1<o.last_page,"total-page":o.last_page,onChangePage:b},null,8,["current-page","first-page","previous-page","next-page","last-page","total-page"])):N("",!0)]),Ut])],64)}}};export{Rt as default};
