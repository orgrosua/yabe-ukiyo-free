import{l as E,m as K,E as M,e as u,x as $,G as j,r as q,o as f,c as g,b as e,t as i,u as n,d as y,h as w,A as B,a as m,F,n as c,k as A,H as G,g as U,w as x,D as l}from"./app-DmP38fiz.js";import{d as L}from"./debounce-XxfNuXcX.js";import{b as X,a as H,u as I}from"./notifier-oDSeFarO.js";import{u as O,a as P,o as W}from"./switch-DdjbC4Z_.js";import"./isObjectLike-mqpIr8Ea.js";import"./isSymbol-BpHlYMiq.js";const Y={class:"mr:8 font:24"},J={class:"form-table",role:"presentation"},Q={scope:"row"},Z=e("span",{class:"fg:red-35"},"*",-1),ee={scope:"row"},te=e("span",{class:"fg:red-35"},"*",-1),ae={key:0,class:"description"},se={key:0},ne={class:"font:semibold"},oe=e("br",null,null,-1),le=e("span",{class:"font:semibold"},"Bricks: ",-1),ie=e("br",null,null,-1),re=e("span",{class:"font:semibold"},"Yabe Ukiyo: ",-1),ue={scope:"row"},ce=e("span",{class:"fg:red-35"},"*",-1),de={class:"flex"},fe={class:"rel flex mr:8 align-items:center"},me=["type"],ye=e("p",{class:"description"},null,-1),pe={scope:"row"},xe={__name:"Show",props:{showSaveButton:{type:Boolean}},setup(be){const D=X(),N=E(),T=K(),S=H(),V=I();M();const z=u({});u(!1);const p=u(!0),v=u(""),k=u(""),r=u(!0),b=u(""),C=u(null),_={status:null,connected:!1,yabeUkiyoDetected:!1,bricksDetected:!1},a=u({..._});$(b,L((s,t)=>{if(s!==t&&(a.value={..._},s!==""&&C.value.checkValidity())){a.value.status="loading";const d=new URL(s.trim().replace(/\/$/,""));D.request({method:"POST",url:"/admin/settings/central_management/check-connection",data:{url:d.origin}}).then(o=>{o.status===200?(a.value={...a.value,status:!0,connected:!0},a.value.yabeUkiyoDetected=o.data.namespaces.find(h=>h==="yabe-ukiyo/v1")!==void 0,a.value.bricksDetected=o.data.namespaces.find(h=>h==="bricks/v1")!==void 0):a.value.status=!1}).catch(o=>{a.value={..._,status:!1}})}},100));async function R(){return V.add("settings.central_management.edit:fetch-item"),D.request({method:"GET",url:`/admin/settings/central_management/detail/${N.params.id}`}).then(s=>s.data).then(s=>{v.value=s.secret_key,k.value=s.title,r.value=s.status,b.value=s.url,z.value=s}).finally(()=>{V.remove("settings.central_management.edit:fetch-item")})}return j(()=>{let s=R();S.async(s,"Site details loaded.",t=>{S.alert(t.response&&t.response.status===404?"Site not found.":"Failed to load site details."),T.go(-1)},"Fetching site details...")}),(s,t)=>{const d=q("font-awesome-icon");return f(),g(F,null,[e("span",Y,"Â» "+i(n(l)("Edit","yabe-ukiyo")),1),e("form",{onSubmit:t[5]||(t[5]=(...o)=>s.sendForm&&s.sendForm(...o))},[e("div",null,[e("table",J,[e("tbody",null,[e("tr",null,[e("th",Q,[e("label",null,[y(i(n(l)("Title","yabe-ukiyo"))+" ",1),Z])]),e("td",null,[w(e("input",{type:"text",name:"title","onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),readonly:""},null,512),[[B,k.value,void 0,{trim:!0,lazy:!0}]])])]),e("tr",null,[e("th",ee,[e("label",null,[y(i(n(l)("Site URL","yabe-ukiyo"))+" ",1),te])]),e("td",null,[w(e("input",{type:"url",ref_key:"urlField",ref:C,name:"url","onUpdate:modelValue":t[1]||(t[1]=o=>b.value=o),readonly:""},null,512),[[B,b.value,void 0,{trim:!0,lazy:!0}]]),a.value.status!==null?(f(),g("p",ae,[a.value.status==="loading"?(f(),g("span",se,[m(d,{icon:["fas","spinner"],class:"mr:4 fg:gray-60 animation:rotate|linear|1s|infinite"}),y(" "+i(n(l)("Connecting","yabe-ukiyo"))+"... ",1)])):(f(),g(F,{key:1},[e("span",ne,i(n(l)("Server","yabe-ukiyo"))+": ",1),e("span",{class:c(a.value.connected?"fg:green-50":"fg:red-40")},i(a.value.connected?n(l)("Connected","yabe-ukiyo"):n(l)("Failed to connect","yabe-ukiyo")),3),oe,le,e("span",{class:c(a.value.bricksDetected?"fg:green-50":"fg:red-40")},i(a.value.bricksDetected?n(l)("Detected","yabe-ukiyo"):n(l)("Not detected","yabe-ukiyo")),3),ie,re,e("span",{class:c(a.value.yabeUkiyoDetected?"fg:green-50":"fg:yellow-60")},i(a.value.yabeUkiyoDetected?n(l)("Detected","yabe-ukiyo"):n(l)("Not detected","yabe-ukiyo")),3)],64))])):A("",!0)])]),e("tr",null,[e("th",ue,[e("label",null,[y(i(n(l)("Secret Key","yabe-ukiyo"))+" ",1),ce])]),e("td",null,[e("div",de,[e("div",fe,[w(e("input",{type:p.value?"text":"password",name:"secret_key","onUpdate:modelValue":t[2]||(t[2]=o=>v.value=o),autocomplete:"current-password",class:"min-w:300 hide::-ms-reveal",readonly:""},null,8,me),[[G,v.value]]),e("span",{onClick:t[3]||(t[3]=o=>p.value=!p.value),class:"flex align-items:center ml:-24 fg:gray-60 fg:gray-40:hover cursor:pointer"},[p.value?(f(),U(d,{key:1,icon:["fas","eye-slash"],class:"font:15"})):(f(),U(d,{key:0,icon:["fas","eye"],class:"font:15"}))])])]),ye])]),e("tr",null,[e("th",pe,[e("label",null,i(n(l)("Status","yabe-ukiyo")),1)]),e("td",null,[m(n(W),{as:"div",class:"flex align-items:center"},{default:x(()=>[m(n(O),{modelValue:r.value,"onUpdate:modelValue":t[4]||(t[4]=o=>r.value=o),"aria-disabled":"true",class:c([[r.value?"bg:sky-60":"opacity:.5 bg:gray-20"],"rel inline-flex p:0 h:24 w:44 flex-shrink:0 cursor:pointer rounded b:2 b:transparent transition-property:color,background-color,border-color,text-decoration-color,fill,stroke transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|2,rgb(14,165,233)|0|0|0|4,rgba(0,0,0,0)|0|0|0|0:focus outline:2|solid|transparent:focus"])},{default:x(()=>[e("span",{class:c([[r.value?"translateX(20)":"translateX(0)"],"pointer-events:none rel inline-block font:12 h:20 w:20 rounded bg:white transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter transition-duration:200 transition-timing-function:cubic-bezier(0.4,0,0.2,1) box-shadow:rgb(255,255,255)|0|0|0|0,rgba(59,130,246,0.5)|0|0|0|0,rgba(0,0,0,0.1)|0|1|3|0,rgba(0,0,0,0.1)|0|1|2|-1"])},[e("span",{"aria-hidden":"true",class:c([[r.value?"opacity:0 transition-timing-function:ease-out transition-duration:100":"opacity:1 transition-timing-function:ease-in transition-duration:200"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[m(d,{icon:["fas","xmark"],class:"fg:gray-60"})],2),e("span",{"aria-hidden":"true",class:c([[r.value?"opacity:1 transition-timing-function:ease-in transition-duration:200":"opacity:0 transition-timing-function:ease-out transition-duration:100"],"abs inset:0 flex h:full w:full align-items:center justify-content:center tw-transition-opacity"])},[m(d,{icon:["fas","check"],class:"fg:sky-60"})],2)],2)]),_:1},8,["modelValue","class"]),m(n(P),{as:"span",class:c([[r.value?"fg:black":"fg:gray-60"],"ml:8 font:medium tw-cursor-pointer"])},{default:x(()=>[y(i(r.value?"enabled":"disabled"),1)]),_:1},8,["class"])]),_:1})])])])])])],32)],64)}}};export{xe as default};
